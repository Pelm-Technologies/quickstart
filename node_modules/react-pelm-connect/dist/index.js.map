{"version":3,"file":"index.js","sources":["../src/useConnect.tsx","../src/connectButton.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { useCallback, useState, useEffect } from 'react';\nimport useScript from 'react-script-hook';\n\nimport { Config } from './types/index'\n\nconst isConnectTokenDefined = (config: Config) => {\n    return config.connectToken !== undefined;\n}\n\nexport const useConnect = (config: Config) => {\n    // For internal use\n    let initializeScriptUrl: string;\n    switch(config.environment) {\n        case 'staging': {\n            initializeScriptUrl = 'https://cdn-staging.pelm.com/initialize.js'\n            break;\n        }\n        case 'development': {\n            initializeScriptUrl = 'http://localhost:8080/initialize.js'\n            break;\n        }\n        default: {\n            initializeScriptUrl = 'https://cdn.pelm.com/initialize.js'\n            break;\n        }\n    }\n\n    const [loading, error] = useScript({ src: initializeScriptUrl });\n    const [isReadyToOpen, setIsReadyToOpen] = useState(false);\n\n    const isServer = typeof window === 'undefined';\n    const isReadyForInitialization =\n        !isServer &&\n        !!window.PelmConnect &&\n        !loading &&\n        !error &&\n        isConnectTokenDefined(config);\n    \n    useEffect(() => {\n        if (isReadyForInitialization && window.PelmConnect) {\n            window.PelmConnect.initialize({\n                ...config,\n                onReady: () => setIsReadyToOpen(true),\n            });\n        }\n    }, [isReadyForInitialization, config]);\n\n    const open = useCallback(() => {\n        if (window.PelmConnect) {\n          window.PelmConnect.open(config);\n        }\n    }, [config]);\n\n    const exit = useCallback(() => {\n        if (window.PelmConnect) {\n          window.PelmConnect.exit();\n        }\n    }, [config]);\n\n    return {\n        error,\n        ready: isReadyToOpen,\n        open,\n        exit\n    };\n}","import * as React from 'react'\n\nimport { useConnect } from './useConnect'\nimport { Config } from './types/index'\n\ntype Props = {\n    config: Config\n    className?: string;\n    children?: React.ReactNode;\n}\n\nexport const ConnectButton = (props: Props) => {\n    const { open, ready, error } = useConnect(props.config);\n\n    return (\n        <>\n            <button\n                type=\"button\"\n                // className=\"button\"\n                onClick={() => open()}\n                // disabled={!ready || error}\n                disabled={!ready}\n            >\n                {\n                    props.children === undefined\n                    ? \"Connect your utility\"\n                    : props.children\n                }\n            </button>\n        </>\n        \n    )\n}"],"names":["useEffect","useCallback","React.createElement"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,IAAM,qBAAqB,GAAG,UAAC,MAAc;IACzC,OAAO,MAAM,CAAC,YAAY,KAAK,SAAS,CAAC;AAC7C,CAAC,CAAA;IAEY,UAAU,GAAG,UAAC,MAAc;;IAErC,IAAI,mBAA2B,CAAC;IAChC,QAAO,MAAM,CAAC,WAAW;QACrB,KAAK,SAAS,EAAE;YACZ,mBAAmB,GAAG,4CAA4C,CAAA;YAClE,MAAM;SACT;QACD,KAAK,aAAa,EAAE;YAChB,mBAAmB,GAAG,qCAAqC,CAAA;YAC3D,MAAM;SACT;QACD,SAAS;YACL,mBAAmB,GAAG,oCAAoC,CAAA;YAC1D,MAAM;SACT;KACJ;IAEK,IAAA,4CAA0D,EAAzD,eAAO,EAAE,aAAK,CAA4C;IAC3D,IAAA,0BAAmD,EAAlD,qBAAa,EAAE,wBAAgB,CAAoB;IAE1D,IAAM,QAAQ,GAAG,OAAO,MAAM,KAAK,WAAW,CAAC;IAC/C,IAAM,wBAAwB,GAC1B,CAAC,QAAQ;QACT,CAAC,CAAC,MAAM,CAAC,WAAW;QACpB,CAAC,OAAO;QACR,CAAC,KAAK;QACN,qBAAqB,CAAC,MAAM,CAAC,CAAC;IAElCA,eAAS,CAAC;QACN,IAAI,wBAAwB,IAAI,MAAM,CAAC,WAAW,EAAE;YAChD,MAAM,CAAC,WAAW,CAAC,UAAU,cACtB,MAAM,IACT,OAAO,EAAE,cAAM,OAAA,gBAAgB,CAAC,IAAI,CAAC,GAAA,IACvC,CAAC;SACN;KACJ,EAAE,CAAC,wBAAwB,EAAE,MAAM,CAAC,CAAC,CAAC;IAEvC,IAAM,IAAI,GAAGC,iBAAW,CAAC;QACrB,IAAI,MAAM,CAAC,WAAW,EAAE;YACtB,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACjC;KACJ,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;IAEb,IAAM,IAAI,GAAGA,iBAAW,CAAC;QACrB,IAAI,MAAM,CAAC,WAAW,EAAE;YACtB,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;SAC3B;KACJ,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;IAEb,OAAO;QACH,KAAK,OAAA;QACL,KAAK,EAAE,aAAa;QACpB,IAAI,MAAA;QACJ,IAAI,MAAA;KACP,CAAC;AACN;;ICxDa,aAAa,GAAG,UAAC,KAAY;IAChC,IAAA,6BAAiD,EAA/C,cAAI,EAAE,gBAAK,CAAqC;IAExD,QACIC;QACIA,gCACI,IAAI,EAAC,QAAQ;;YAEb,OAAO,EAAE,cAAM,OAAA,IAAI,EAAE,GAAA;;YAErB,QAAQ,EAAE,CAAC,KAAK,IAGZ,KAAK,CAAC,QAAQ,KAAK,SAAS;cAC1B,sBAAsB;cACtB,KAAK,CAAC,QAAQ,CAEf,CACV,EAEN;AACL,CAAC;;;;;"}